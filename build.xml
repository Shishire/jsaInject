<?xml version="1.0" encoding="utf-8"?>
<!--
	jsaInject build script
	
	all               Build and test everything; create a distribution.
	default           Perform a default build; don't clean/test.
	main              Build main code.
	clean             Delete all generated files and directories.
	dist              Produce the distributables.
	distclean         Clean up the distribution files only.
	docs              Generate all documentation.
	init              Initialize the build: create directories, call <tstamp> and other common actions.
	jsdocs            Generate the JSdoc pages.
	printerdocs       Generate printable documents.
	test              Run the unit tests.
-->

<project name="jsaInject" default="default">
	<property name="src.dir" value="src" />
	<property name="build.dir" value="build" />
	<property name="lib.dir" value="lib" />


	<target name="default" depends="init,main,dist">
	
	</target>
	<target name="all" depends="clean,init,main,docs,dist,test" description="Build and test everything; create a distribution.">
	
	</target>
	<target name="init">
	
	</target>
	<target name="clean" depends="init,distclean" description="Delete all generated files and directories.">
	
	</target>
	<target name="main" depends="init,concat-all,compress" description="Build main code.">
	
	</target>
	<target name="build-filters" depends="init">
		<concat destfile="${build.dir}/jsaInject.filters.js">
			<fileset dir="${src.dir}/filters">
				<include name="jsaInject.filter.white.*.js" />
				<include name="jsaInject.filter.black.*.js" />
			</fileset>
		</concat>
	</target>
	<target name="build-core" depends="init">
		<concat destfile="${build.dir}/jsaInject.core.js">
			<fileset dir="${src.dir}/core">
				<include name="jsaInject.*.js" />
			</fileset>
		</concat>
	</target>
	<target name="concat-all" depends="init,build-filters,build-core">
		<concat destfile="${build.dir}/jsaInject.concat.js">
			<fileset dir="${build.dir}">
				<include name="jsaInject.core.js" />
				<include name="jsaInject.filters.js" />
			</fileset>
		</concat>
	</target>
	<target name="compress" depends="init,concat-all">
		<closure-compress output="${build.dir}/jsaInject.compress.js" compilationLevel="advanced" warning="verbose" debug="false" >
			<sources dir="${build.dir}">
				<file name="jsaInject.concat.js" />
			</sources>
			<externs dir="${src.dir}">
				<file name="externs.js" />
			</externs>
			<externs dir="${lib.dir}/closure-compiler">
				<file name="jquery-1.6.js" />
			</externs>
		</closure-compress>
	</target>
	<target name="docs" depends="init,jsdocs,printerdocs" description="Generate all documentation.">
	
	</target>
	<target name="jsdocs" depends="init">
	
	</target>
	<target name="printerdocs" depends="init">
	
	</target>
	<target name="dist" depends="init,main" description="Produce the distributables.">
	
	</target>
	<target name="distclean" depends="init">
	
	</target>
	<target name="test" depends="init,main" description="Run the unit tests.">
	
	</target>
	<target name="prepare-for-release" depends="init,update-version" description="Prepare the build for a new release version.">
	
	</target>
	<target name="update-version" depends="init">
	
	</target>
	<target name="usage" description="Display usage information.">
	
	</target>

	<taskdef name="closure-compress" classname="com.google.javascript.jscomp.ant.CompileTask" classpath="${lib.dir}/closure-compiler/compiler.jar" />
</project>
